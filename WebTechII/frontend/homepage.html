<!DOCTYPE html>
<html>
<head>
    <style>
        #container{
        border:solid .5px black;
        display:none
        }
        .fooditem{
        
          background-color:grey;
          color:black;	
        }
        .fooditem:hover{
        
          background-color:white;
        }

        body{
          background: #ffd89b;
          background: -webkit-linear-gradient(to right, #ffd89b, #19547b);
          background: linear-gradient(to right, #ffd89b, #19547b);}

        </style>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>JS Bin</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<style>
body{
  font-size: 1.4rem;
}

nav {
    background-color: rgb(113, 158, 158) ;
    width: 100%;
    height: 60px;
     
        };

.card-img-top {
    min-width: 100%;
    width: auto;
    height: auto;
}
</style>

</head>
<body>
<!--Navbar-->
<nav class="navbar navbar-expand-lg navbar-dark primary-color">

    <!-- Navbar brand -->
    <a class="navbar-brand" href="#">Gagdet Shop <i class="glyphicon glyphicon-headphones"></i>
    </a>
  
    <!-- Collapse button -->
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
      aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  
    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="basicExampleNav">
  
      <!-- Links -->
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a class="nav-link" href="homepage.html">Home
            <span class="sr-only">(current)</span>
            <i class="glyphicon glyphicon-home"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">MyOrders <i class="glyphicon glyphicon-folder-open"></i></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">AboutUs <i class="glyphicon glyphicon-info-sign"></i>
          </a>
        </li>
  
        <!-- Dropdown -->
      
        <li class="nav-item" style="margin-left:250px;">
          <a class="nav-link" href="#" id="username">Hi,<i class="glyphicon glyphicon-user"></i>
          </a>
        </li>
      <!-- Dropdown -->
      
      <li class="nav-item" style="margin-left:10px;">
        <a class="nav-link" href="#" id="username" onclick="loggingout()"><span class="glyphicon glyphicon-log-out">Logout</span>
        </a>
        
</li>
    

<li class="nav-item" style="margin-left:150px;margin-top:10px ;">
        <button type="button" class="btn btn-primary" onclick="loadcartpage()" style="height:35px;background-color: green;width: 110%;font-size:15px;">
                Cart <span class="badge badge-light" id="noofprods">4</span>
         </button>
</li>

      </ul>
      <!-- Links -->
  
      
    </div>
    <!-- Collapsible content -->
  
  </nav>  <!--/.Navbar-->
<!--<div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
    <div class="card h-100">
        <a href="#"><img class="card-img-top" src="" alt=""></a>
              <div class="card-body">
                <h4 class="card-title">
                  <a href="#">Item Five</a>
                </h4>
                <h5>$24.99</h5>
                <p class="card-text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Amet numquam aspernatur! Lorem ipsum dolor sit amet.</p>
              </div>
              <div class="card-footer">
                <small class="text-muted">&#9733; &#9733; &#9733; &#9733; &#9734;</small>
              </div>
    </div>
</div>
-->


<div class="container">
  <div id="myCarousel" class="carousel slide" data-ride="carousel">
    <!-- Indicators -->
    <ol class="carousel-indicators">
      <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
      <li data-target="#myCarousel" data-slide-to="1"></li>
      <li data-target="#myCarousel" data-slide-to="2"></li>
      
    </ol>

    <!-- Wrapper for slides -->
    <div class="carousel-inner">
      <div class="item active">
        <img src="1.png" alt="Los Angeles" onclick="loadprodcarousel(1)" style="width:110%;height:550px;">
      </div>

      <div class="item">
        <img src="2.jpg" alt="Chicago" onclick="loadprodcarousel(15)" style="width:110%;height: 550px;">
      </div>
    
      <div class="item">
        <img src="3.jpg" alt="New york" onclick="loadprodcarousel(9)" style="width:100%;height: 550px;">
      </div>
     

    <!-- Left and right controls -->
    <a class="left carousel-control" href="#myCarousel" data-slide="prev">
      <span class="glyphicon glyphicon-chevron-left"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="right carousel-control" href="#myCarousel" data-slide="next">
      <span class="glyphicon glyphicon-chevron-right"></span>
      <span class="sr-only">Next</span>
    </a>
  </div>
</div>

<img src="i.jpeg" id ="imsr" style="display: none;"> 
<br><hr><br>



<!--<div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
    <div class="card h-100">
        <a href="#"><img class="card-img-top" src="i.jpeg" alt="" style="width:65%;height:300px;display:block;margin-left:auto;margin-right:auto;"> </a>
              <div class="card-body">
                <h4 class="card-title">
                  <a href="#">Item Five</a>
                </h4>
                <h5>$24.99</h5>
                <p class="card-text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Amet numquam aspernatur! Lorem ipsum dolor sit amet.</p>
              </div>
              <div class="card-footer">
                <small class="text-muted">&#9733; &#9733; &#9733; &#9733; &#9734;</small>
              </div>
    </div>
</div>
-->
<div class="card text-center">
  <div class="card-header">
    Products
  </div>
  <div class="card-body">
    <h5 class="card-title">Welcome to Gagdetshop</h5>
    <p class="card-text">To explore our products click the button below</p>
    <a href="products.html" class="btn btn-primary">Click here</a>
  </div>
  <div class="card-footer text-muted">
    Last update 2 days ago
  </div>
</div>

<br><hr><br>

<table cellpadding="0">
		<tr><td></td><td><form action="#" >
         
      <div class="input-group mb-4">
        <input type="search" style="height: 40px;font-size:20px ;width: 500px;" placeholder="What're you searching for?" onkeypress="obj.getTerm()" aria-describedby="button-addon6" class="form-control" id="search">
        <div class="input-group-append">
          <a><button id="button-addon6" style="width: 100px;font-size:20px;" onclick="setprodit()" type="submit" class="btn btn-info">Search</button>
        </div>
      </div>
      
     
    </form></td></tr>
		<tr><td></td><td><div id="container"></td></div></tr>
		</table>
   

   
    


<p style="height: 500px;"></p>
</body>
<script>
cartitems=JSON.parse(localStorage.getItem("cart"));
var len=Object.keys(cartitems).length;
document.getElementById("noofprods").innerHTML=len;

var username=document.getElementById("username")
username.innerHTML+=localStorage.getItem("presentuser");



function Suggest(){
		//Maintain a reference to the current object
			var object=this;
			this.timer=null;
			this.search=null;
			this.container=null;
			this.url=null;
			this.xhr=new XMLHttpRequest();
			this.getTerm=function(){
				this.search=document.getElementById("search");
				this.container=document.getElementById("container");
			//to invoke the send search function only if the user
			//pauses for a second			
				if(this.timer){
					clearTimeout(this.timer);
				}
				this.timer=setTimeout(this.sendTerm,1000)
				
			
			}
/*
      this.sendTerm=function(){
				object.url="suggest.php?term="+object.search.value;
				//check if the search term is available in cache
				// i.e. Local Storage
        //object.url=["avinash","chavan"];
				if(localStorage.getItem(object.url)){
					var cacheRes=JSON.parse(localStorage.getItem(object.url))
					object.populateFood(cacheRes);
					console.log(localStorage.getItem(object.url));
					console.log("from browser cache")
				}
				else{
				object.xhr.onreadystatechange=object.showResult;
				console.log(object.search.value)
				//console.log(this)
				object.xhr.open("GET",object.url,true);
				object.xhr.send();
				}
			}


*/



			this.sendTerm=function(){
        var searchval=object.search.value;
				object.url="http://localhost:5000/productname";
				dict={"name":searchval};
				
				object.xhr.onreadystatechange=object.showResult;
				console.log(object.search.value)
				//console.log(this)
				object.xhr.open("POST",object.url,true);
        object.xhr.setRequestHeader("Content-Type","application/json");
        var data=JSON.stringify(dict)
				object.xhr.send(data);
				
			}

      
			this.showResult=function(){
				if(this.readyState==4 && this.status==200){
					var res=this.responseText;
          console.log(res);
					var resO=JSON.parse(res);
					//Store search result in cache
					localStorage.setItem(object.url,res);
					if(resO.length==0){
					
						object.search.style.backgroundColor="red"
						object.search.style.fontStyle="italics"
					}
					else{
						object.populateFood(resO);	
					}
				}
			}
			this.populateFood=function(resO){
				object.container.innerHTML="";
				for(f in resO){
					
					var itemDiv=document.createElement("div");
					itemDiv.innerHTML=resO[f];
					itemDiv.className="fooditem";
					itemDiv.onclick=object.setFood;
					object.container.appendChild(itemDiv)
					console.log(object.container)
				}
				object.container.style.display="block";
				console.log(object.container)
			
			
			}
			this.setFood=function(e){
				object.search.value=e.target.innerHTML;
				object.search.style.backgroundColor="white";
				object.container.style.display="none"
				object.container.innerHTML="";
			
			}
		
		
		
		}
		
		var obj=new Suggest();


function getprods(){

  var a=document.getElementById("search").value;
  console.log(a);

  dict={"name":a};
  xhr =new XMLHttpRequest;
  xhr.onreadystatechange=setcat;

  var url="http://localhost:5000/productname";
  xhr.open("POST",url,true);
  xhr.setRequestHeader("Content-Type","application/json");
  var data=JSON.stringify(dict);
  xhr.send(data);
}

function setcat(){
  if(xhr.readyState==4 && xhr.status==200)
  {
    console.log("successfully recieved");
  }
}


function setprodit(){
  var prodname=document.getElementById("search").value;
  console.log(prodname);
  dict={"name":prodname};
  xhr =new XMLHttpRequest;
  xhr.onreadystatechange=setprodid;

  var url="http://localhost:5000/producttoid";
  xhr.open("POST",url,true);
  xhr.setRequestHeader("Content-Type","application/json");
  var data=JSON.stringify(dict);
  xhr.send(data);


}

function setprodid(){
  if(xhr.readyState==4 && xhr.status==200)
  {
    var res=JSON.parse(xhr.responseText);
    localStorage.setItem("productid",res);
    console.log(res,"setting");
    location.replace("http://localhost/frontend/product.html");
  }
}


function loadprodcarousel(i){
  localStorage.setItem("productid",i);
  location.replace("product.html")
}

function loggingout(){
  console.log("will log you out");
  localStorage.removeItem("presentuser");
  localStorage.removeItem("cart")
  window.location.replace("index.html");
}
function loadcartpage(){
  window.location.replace("cart.html")
}
</script>
</html>